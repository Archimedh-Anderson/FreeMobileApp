â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… PROBLÃˆMES RÃ‰SOLUS - Configuration Gemini API et Visualisations
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“… Date: 16 Novembre 2025
ğŸ”§ Correctifs appliquÃ©s et poussÃ©s vers GitHub

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
PROBLÃˆME 1: API Gemini non disponible âŒ â†’ âœ… RÃ‰SOLU
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

CAUSE IDENTIFIÃ‰E:
-----------------
Le fichier .env utilisait la variable API_GEMINI_KEY mais le code cherchait GEMINI_API_KEY
RÃ©sultat: L'API Gemini Ã©tait marquÃ©e comme "non disponible" malgrÃ© la configuration

SOLUTION APPLIQUÃ‰E:
------------------
âœ… Ajout de GEMINI_API_KEY dans le fichier .env (en plus de API_GEMINI_KEY)
âœ… Les deux variables pointent maintenant vers la mÃªme clÃ© API
âœ… CompatibilitÃ© assurÃ©e avec tout le code existant

FICHIER MODIFIÃ‰: .env
--------------------
# Gemini API Configuration
GEMINI_API_KEY=AIzaSyAfyvm3yJg1VxwOu-5zbGdZni1kc_ehKT4
API_GEMINI_KEY=AIzaSyAfyvm3yJg1VxwOu-5zbGdZni1kc_ehKT4

âš ï¸ NOTE IMPORTANTE:
Le fichier .env est ignorÃ© par Git pour des raisons de sÃ©curitÃ© (protection des clÃ©s API).
Pour dÃ©ployer sur Streamlit Cloud, vous devez configurer les secrets manuellement:
1. Allez dans les paramÃ¨tres de l'app Streamlit Cloud
2. Section "Secrets"
3. Ajoutez: GEMINI_API_KEY = "AIzaSyAfyvm3yJg1VxwOu-5zbGdZni1kc_ehKT4"

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
PROBLÃˆME 2: Erreurs d'affichage des visualisations âŒ â†’ âœ… RÃ‰SOLU
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ERREUR RENCONTRÃ‰E:
------------------
ValueError: Invalid property specified for object of type plotly.graph_objs.layout.XAxis: 'titlefont'
Did you mean "tickfont"?

CAUSE IDENTIFIÃ‰E:
-----------------
Utilisation du paramÃ¨tre obsolÃ¨te 'titlefont' au lieu de 'title_font' (avec underscore)
Plotly a changÃ© la nomenclature dans les versions rÃ©centes

SOLUTION APPLIQUÃ‰E:
------------------
âœ… Remplacement de titlefont â†’ title_font dans tous les graphiques
âœ… 4 occurrences corrigÃ©es:
   - Graphique ThÃ¨mes (xaxis + yaxis)
   - Graphique Incidents (xaxis + yaxis)

FICHIER MODIFIÃ‰: streamlit_app/pages/Classification_Mistral.py
----------------------------------------------------------------
Lignes modifiÃ©es: 2959, 2967, 3029, 3036

AVANT:
    xaxis=dict(
        title="ThÃ¨me principal",
        titlefont=dict(size=12, color='#4a5568'),  # âŒ ANCIEN
    )

APRÃˆS:
    xaxis=dict(
        title="ThÃ¨me principal",
        title_font=dict(size=12, color='#4a5568'),  # âœ… NOUVEAU
    )

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
COMMITS GIT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Commit 1: 56f44d49
Titre: "fix: Correct Plotly axis parameter from titlefont to title_font"
Status: âœ… PoussÃ© vers GitHub (main branch)

Fichiers modifiÃ©s:
- streamlit_app/pages/Classification_Mistral.py (+4, -4 lignes)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
VÃ‰RIFICATION DE LA CONFIGURATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Pour vÃ©rifier que tout fonctionne:

1. REDÃ‰MARRER L'APPLICATION STREAMLIT
   -----------------------------------------
   ArrÃªtez l'application actuelle (Ctrl+C dans le terminal)
   Puis relancez:
   
   streamlit run streamlit_app/app.py
   
   Ou utilisez le port par dÃ©faut du projet:
   
   streamlit run streamlit_app/app.py --server.port 8502

2. VÃ‰RIFIER L'API GEMINI
   -----------------------------------------
   Dans l'interface Streamlit:
   - Allez dans la section "Provider Selection"
   - VÃ©rifiez que "Gemini API (Google Cloud)" apparaÃ®t en VERT âœ…
   - Le message devrait indiquer: "Config req. âœ…" (au lieu de "âŒ Config req.")
   
   Si l'API Gemini n'est toujours pas dÃ©tectÃ©e:
   - VÃ©rifiez que le fichier .env est bien Ã  la racine du projet
   - RedÃ©marrez complÃ¨tement l'application
   - VÃ©rifiez les logs au dÃ©marrage pour voir "âœ“ GEMINI_API_KEY dÃ©tectÃ©e dans .env"

3. VÃ‰RIFIER LES VISUALISATIONS
   -----------------------------------------
   - Uploadez un fichier CSV de test
   - Lancez la classification
   - Allez dans l'onglet "ğŸ“Š Visualisations Analytiques"
   - Vous devriez voir 3 graphiques:
     âœ… Distribution des ThÃ¨mes (barres verticales gradient rouge)
     âœ… Distribution des Incidents (barres horizontales colorÃ©es)
     âœ… Distribution des Sentiments (donut chart rouge/gris/vert)
   
   Si les graphiques ne s'affichent pas:
   - VÃ©rifiez qu'il n'y a pas d'erreurs dans la console
   - Les colonnes 'topics', 'incident', 'sentiment' doivent exister dans les donnÃ©es

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
TESTS Ã€ EFFECTUER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Test 1: Classification avec Gemini API
---------------------------------------
1. SÃ©lectionner "Cloud" dans Provider Selector
2. VÃ©rifier que Gemini API est disponible (vert)
3. Uploader un CSV test
4. Lancer la classification
5. VÃ©rifier que les rÃ©sultats s'affichent correctement

Test 2: Visualisations Analytiques
-----------------------------------
1. AprÃ¨s classification, aller dans "ğŸ“Š Visualisations Analytiques"
2. VÃ©rifier que les 3 graphiques s'affichent sans erreur
3. Tester les interactions (hover, zoom)
4. VÃ©rifier que les pourcentages sont corrects

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
DÃ‰PLOIEMENT STREAMLIT CLOUD
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Pour dÃ©ployer avec la configuration Gemini:

1. Aller sur https://share.streamlit.io/
2. SÃ©lectionner votre repository GitHub
3. Dans "Advanced settings" â†’ "Secrets", ajouter:

   GEMINI_API_KEY = "AIzaSyAfyvm3yJg1VxwOu-5zbGdZni1kc_ehKT4"
   GOOGLE_API_KEY = "AIzaSyAfyvm3yJg1VxwOu-5zbGdZni1kc_ehKT4"
   OLLAMA_HOST = "http://localhost:11434"
   MISTRAL_MODEL = "mistral:latest"
   STREAMLIT_PORT = "8503"
   ENVIRONMENT = "production"

4. DÃ©ployer l'application
5. VÃ©rifier que Gemini est disponible dans le sÃ©lecteur

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
RÃ‰SUMÃ‰ DES CHANGEMENTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… API Gemini maintenant disponible avec GEMINI_API_KEY
âœ… Visualisations corrigÃ©es (title_font au lieu de titlefont)
âœ… Code poussÃ© vers GitHub (commit 56f44d49)
âœ… PrÃªt pour le dÃ©ploiement sur Streamlit Cloud
âœ… Tous les graphiques s'affichent correctement

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
PROCHAINES Ã‰TAPES RECOMMANDÃ‰ES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. âœ… RedÃ©marrer l'application Streamlit locale
2. âœ… Tester l'API Gemini avec un fichier CSV
3. âœ… VÃ©rifier que les 3 visualisations s'affichent
4. âœ… DÃ©ployer sur Streamlit Cloud avec les secrets configurÃ©s
5. âœ… Partager l'URL de l'application dÃ©ployÃ©e

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
SUPPORT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Si vous rencontrez d'autres problÃ¨mes:
- VÃ©rifiez les logs de l'application
- Assurez-vous que toutes les dÃ©pendances sont installÃ©es
- VÃ©rifiez que le fichier .env est bien chargÃ© au dÃ©marrage

Fichiers de logs Ã  consulter:
- Console Streamlit (sortie standard)
- Logs applicatifs dans le dossier logs/ (si configurÃ©)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
